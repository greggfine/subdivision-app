{"ast":null,"code":"/*\n\t-------------------------------------------------------\n\tutil/DOMMisc : 0.2.1 : 2015-04-27 : https://sketch.io\n\t-------------------------------------------------------\n*/\nif (typeof galactic === 'undefined') galactic = {};\n\n(function (root) {\n  'use strict';\n\n  root.module = root.module || {};\n\n  root.module.DOMMisc = function (root) {\n    var util = root.util || (root.util = {});\n    /* Inherits\n    ---------------------------------------------------------- */\n\n    util.inherits = function (child, parent) {\n      function temp() {}\n\n      ;\n      temp.prototype = parent.prototype;\n      child.prototype = new temp();\n      child.prototype.constructor = child;\n    };\n    /* Error handler\n    ---------------------------------------------------------- */\n\n\n    util.errorHandler = function (type) {\n      return function () {\n        console.warn(type, arguments);\n      };\n    };\n    /* Kiosk\n    ---------------------------------------------------------- */\n\n\n    util.requestKioskMode = function () {\n      if (root.client.nodewebkit) {\n        //TODO-PER: to make it compile\t\t\tvar win = require('nw.gui').Window.get();\n        win.enterKioskMode();\n      } else {//\t\t\troot.FullScreen.enter();\n      }\n    };\n    /* Diff\n    ---------------------------------------------------------- */\n\n\n    util.diff = function (_from, _to, _retain) {\n      // see style.js\n      if (_from === _to) return; ///\n\n      var from = new _from.constructor();\n      var to = new _to.constructor();\n      var equal = true;\n\n      for (var key in _from) {\n        if (_retain && _retain.indexOf(key) !== -1) {\n          from[key] = _from[key];\n          to[key] = _to[key];\n        } else if (!(key in _to)) {\n          equal = false;\n          from[key] = _from[key];\n          to[key] = _to[key];\n        } else {\n          if (_from[key] !== _to[key]) {\n            if (typeof _from[key] === 'object' && typeof _to[key] === 'object') {\n              var diff = util.diff(_from[key], _to[key], _retain);\n\n              if (diff !== undefined) {\n                equal = false;\n                from[key] = diff.from;\n                to[key] = diff.to;\n              }\n            } else {\n              equal = false;\n              from[key] = _from[key];\n              to[key] = _to[key];\n            }\n          }\n        }\n      }\n\n      for (var key in _to) {\n        if (!(key in _from)) {\n          equal = false;\n          from[key] = _from[key];\n          to[key] = _to[key];\n        }\n      }\n\n      if (!equal) {\n        return {\n          from: from,\n          to: to\n        };\n      }\n    };\n    /* Sort\n    --------------------------------------------------- \n    \tutil.sort({\n    \t\tfn: 'natural', // string | custom function\n    \t\tdata: {},\n    \t\tparam: 'columnId'\n    \t});\n    */\n\n\n    util.sort = function (opts) {\n      var fn = util.sort[opts.fn] || opts.fn;\n      var data = opts.data || opts;\n      var param = opts.param; ///\n\n      var res;\n\n      if (Array.isArray(data)) {\n        // sort arrays\n        if (param) {\n          // sort array by param\n          res = data.sort(function (a, b) {\n            return fn(a[param], b[param]);\n          });\n        } else {\n          // sort array with custom function\n          res = data.sort(fn);\n        }\n      } else {\n        // sort object by key\n        res = {};\n        Object.keys(data).sort(fn).forEach(function (idx) {\n          res[idx] = data[idx];\n        });\n      }\n\n      return res;\n    };\n\n    util.sort.numeric = function (a, b) {\n      return a - b;\n    };\n    /*\n     * Natural Sort algorithm for Javascript - Version 0.6 - Released under MIT license\n     * Author: Jim Palmer (based on chunking idea from Dave Koelle)\n     * Contributors: Mike Grier (mgrier.com), Clint Priest, Kyle Adams, guillermo\n     */\n\n\n    util.sort.natural = function (a, b) {\n      // http://www.overset.com/2008/09/01/javascript-natural-sort-algorithm-with-unicode-support/\n      var re = /(^-?[0-9]+(\\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi;\n      var sre = /(^[ ]*|[ ]*$)/g;\n      var dre = /(^([\\w ]+,?[\\w ]+)?[\\w ]+,?[\\w ]+\\d+:\\d+(:\\d+)?[\\w ]?|^\\d{1,4}[\\/\\-]\\d{1,4}[\\/\\-]\\d{1,4}|^\\w+, \\w+ \\d+, \\d{4})/;\n      var hre = /^0x[0-9a-f]+$/i;\n      var ore = /^0/; // convert all to strings and trim()\n\n      var x = a.toString().replace(sre, '') || '';\n      var y = b.toString().replace(sre, '') || ''; // chunk/tokenize\n\n      var xN = x.replace(re, '\\0$1\\0').replace(/\\0$/, '').replace(/^\\0/, '').split('\\0');\n      var yN = y.replace(re, '\\0$1\\0').replace(/\\0$/, '').replace(/^\\0/, '').split('\\0'); // numeric, hex or date detection\n\n      var xD = parseInt(x.match(hre)) || xN.length != 1 && x.match(dre) && Date.parse(x);\n      var yD = parseInt(y.match(hre)) || xD && y.match(dre) && Date.parse(y) || null; // first try and sort Hex codes or Dates\n\n      if (yD) {\n        if (xD < yD) {\n          return -1;\n        } else if (xD > yD) {\n          return 1;\n        }\n      } // natural sorting through split numeric strings and default strings\n\n\n      for (var cLoc = 0, numS = Math.max(xN.length, yN.length); cLoc < numS; cLoc++) {\n        // find floats not starting with '0', string or 0 if not defined (Clint Priest)\n        var oFxNcL = !(xN[cLoc] || '').match(ore) && parseFloat(xN[cLoc]) || xN[cLoc] || 0;\n        var oFyNcL = !(yN[cLoc] || '').match(ore) && parseFloat(yN[cLoc]) || yN[cLoc] || 0; // handle numeric vs string comparison - number < string - (Kyle Adams)\n\n        if (isNaN(oFxNcL) !== isNaN(oFyNcL)) {\n          return isNaN(oFxNcL) ? 1 : -1;\n        } else if (typeof oFxNcL !== typeof oFyNcL) {\n          // rely on string comparison if different types - i.e. '02' < 2 != '02' < '2'\n          oFxNcL += '';\n          oFyNcL += '';\n        }\n\n        if (oFxNcL < oFyNcL) {\n          return -1;\n        } else if (oFxNcL > oFyNcL) {\n          return 1;\n        }\n      }\n\n      return 0;\n    };\n    /* LocalStorage\n    --------------------------------------------------- */\n\n\n    util.getItems = function (keys, onsuccess) {\n      var pending = keys.length;\n      var res = {};\n      util.each(keys, function (key) {\n        util.getItem(key, function (value) {\n          res[key] = value; ///\n\n          if (! --pending) {\n            onsuccess(res);\n          }\n        });\n      });\n    };\n\n    util.getItem = function (key, onsuccess) {\n      onsuccess = onsuccess || function (value) {\n        console.log(value);\n      }; ///\n\n\n      var parse = function (value) {\n        if (value) {\n          try {\n            value = JSON.parse(value);\n          } catch (err) {}\n        } ///\n\n\n        onsuccess(value);\n      }; ///\n\n\n      if (util.exists('chrome.storage.local')) {\n        // Chrome Packaged Apps\n        chrome.storage.local.get(key, function (data) {\n          parse(data[key]);\n        });\n      } else {\n        var prefix = root.feature && root.feature.prefix || '';\n        var prefixed = prefix + '/' + key;\n        var data = localStorage.getItem(prefixed) || '';\n        parse(data);\n      }\n    };\n\n    util.setItem = function (key, value) {\n      if (util.exists('chrome.storage.local')) {\n        // Chrome Packaged Apps\n        var obj = {};\n        obj[key] = value;\n        chrome.storage.local.set(obj);\n      } else {\n        var prefix = root.feature && root.feature.prefix || '';\n        var prefixed = prefix + '/' + key;\n        localStorage.setItem(prefixed, value);\n      }\n    };\n    /* Canvas\n    --------------------------------------------------- */\n\n\n    util.Canvas = function (width, height, type) {\n      if (typeof document === 'undefined') {\n        // NodeJS\n        if (Canvas === undefined) {\n          return {\n            ctx: {}\n          };\n        } else {\n          var canvas = new Canvas();\n        }\n      } else {\n        // FlashCanvas | DOM\n        var canvas = document.createElement('canvas');\n\n        if (typeof FlashCanvas === 'function') {\n          canvas.onload = root.client.fn.detect;\n        }\n      } ///\n\n\n      canvas.ctx = canvas.getContext(type || '2d'); ///\n\n      if (isFinite(width)) {\n        canvas.width = width || 1;\n      }\n\n      if (isFinite(height)) {\n        canvas.height = height || 1;\n      }\n\n      return canvas;\n    };\n\n    util.Canvas.resize = function (canvas, width, height) {\n      // clear context\n      if (width && height) {\n        canvas.width = width;\n        canvas.height = height;\n      } else {\n        canvas.width = canvas.width;\n      }\n    };\n\n    util.Canvas.clear = function (canvas) {\n      // clear context rectangle\n      canvas.ctx.clearRect(0, 0, canvas.width, canvas.height);\n    };\n    /* Context\n    --------------------------------------------------- */\n\n\n    util.Context3d = function (width, height) {\n      return util.Canvas(width, height, 'webgl').ctx;\n    };\n\n    util.Context2d = function (width, height) {\n      return util.Canvas(width, height, '2d').ctx;\n    };\n    /* JSON\n    --------------------------------------------------- */\n\n\n    util.json = {};\n\n    util.json.pretty = function (data) {\n      return JSON.stringify(data, null, '\\t');\n    };\n\n    util.json.stringify = function (data) {\n      return JSON.stringify(data, function (key, value) {\n        // filter circular\n        if (typeof value === 'object') {\n          if (value === null) return; // NULL\n\n          if (value.nodeName) return; // DOM Node\n\n          if (value.tagName) return; // DOM Element\n        }\n\n        return value;\n      });\n    };\n    /* Timestamp\n    --------------------------------------------------- */\n\n\n    util.timestamp = function () {\n      if (typeof window === 'object') {\n        var performance = window.performance;\n\n        if (performance && performance.now) {\n          return performance.now.bind(performance);\n        }\n      }\n\n      return Date.now;\n    }();\n    /* Perf\n    --------------------------------------------------- */\n\n\n    util.perf = function (fn, amount, title) {\n      if (amount && fn) {\n        var perf = util.perf();\n\n        for (var n = 0; n < amount; n++) fn();\n\n        console.log(perf() + 'ms', title || '');\n      } else {\n        var start = util.timestamp();\n        return function (title, reset) {\n          var now = util.timestamp();\n          var diff = Math.round(now - start);\n\n          if (title) {\n            console.log(diff + 'ms', title);\n          }\n\n          if (reset) {\n            start = now;\n          }\n\n          return diff;\n        };\n      }\n    };\n\n    util.exists = function (path, base) {\n      // exists('scene.children', sketch)\n      try {\n        var parts = path.split('.');\n        var obj = base || window;\n\n        for (var n = 0, length = parts.length; n < length; n++) {\n          var key = parts[n];\n\n          if (obj[key] == null) {\n            return false;\n          } else {\n            obj = obj[key];\n          }\n        }\n\n        return true;\n      } catch (err) {\n        return false;\n      }\n    };\n    /* Clone objects\n    --------------------------------------------------- */\n\n\n    util.copy = function () {\n      var excludePattern = typeof CanvasPattern === 'function';\n\n      var copy = function (src) {\n        if (!src || typeof src !== 'object') {\n          return src;\n        } else if (src.nodeType) {\n          return; // dom element\n        } else if (excludePattern && src instanceof CanvasPattern) {\n          return;\n        } else if (src.clone && typeof src.clone === 'function') {\n          return src.clone();\n        } else if (src.constructor) {\n          var temp = new src.constructor();\n\n          for (var key in src) {\n            var fvalue = src[key];\n\n            if (!fvalue || typeof fvalue !== 'object') {\n              temp[key] = fvalue;\n            } else {\n              // clone sub-object\n              temp[key] = copy(fvalue);\n            }\n          }\n\n          return temp;\n        }\n      };\n\n      return copy;\n    }();\n    /* Merge objects\n    --------------------------------------------------- */\n\n\n    util.copyInto = function () {\n      var copyInto = function (src, dst, opts) {\n        opts = opts || {};\n\n        if (src && typeof src === 'object') {\n          for (var key in src) {\n            var tvalue = dst[key];\n            var fvalue = src[key]; ///\n\n            var filter = opts.filter;\n\n            if (filter && filter(fvalue, tvalue)) {\n              continue;\n            } ///\n\n\n            var ftype = typeof fvalue;\n\n            if (fvalue && ftype === 'object') {\n              if (fvalue.nodeType) {\n                if (opts.referenceNodes) {\n                  dst[key] = fvalue;\n                } else {\n                  continue; // dom element\n                }\n              } else {\n                if (typeof tvalue === ftype) {\n                  dst[key] = copyInto(fvalue, tvalue, opts);\n                } else {\n                  dst[key] = copyInto(fvalue, new fvalue.constructor(), opts);\n                }\n              }\n            } else {\n              dst[key] = fvalue;\n            }\n          }\n        }\n\n        return dst;\n      };\n\n      return copyInto;\n    }();\n    /* Count objects\n    --------------------------------------------------- */\n\n\n    util.count = function (obj, whereKey, whereValue) {\n      if (obj) {\n        if (isFinite(obj.length)) {\n          return obj.length;\n        } else if (typeof obj === 'object') {\n          var length = 0;\n          var useKey = whereKey !== undefined; //- replace with filter()\n\n          var useValue = whereValue !== undefined;\n\n          if (useKey && useValue) {\n            for (var key in obj) {\n              if (obj[key] && obj[key][whereKey] === whereValue) {\n                ++length;\n              }\n            }\n          } else if (useKey) {\n            for (var key in obj) {\n              if (obj[key] !== undefined) {\n                ++length;\n              }\n            }\n          } else {\n            for (var key in obj) ++length;\n          }\n\n          return length;\n        }\n      } else {\n        return 0;\n      }\n    };\n\n    util.isEmpty = function (obj) {\n      if (obj == null) {\n        // undefined | null\n        return true;\n      } else if (obj.length >= 0) {\n        // array | string | arguments\n        return !obj.length;\n      } else {\n        // object\n        for (var key in obj) {\n          return false;\n        }\n\n        return true;\n      }\n    };\n\n    util.isNotEmpty = function (obj) {\n      return !util.isEmpty(obj);\n    };\n\n    util.clamp = function (min, max, value) {\n      return value < min ? min : value > max ? max : value;\n    };\n\n    util.clampFinite = function (value) {\n      var INFINITY = util.INFINITY;\n      if (value > +INFINITY) value = +INFINITY;\n      if (value < -INFINITY) value = -INFINITY;\n      return value;\n    };\n\n    util.arrayEmpty = function (arr) {\n      arr.splice(0, arr.length);\n    };\n\n    util.arrayIntersects = function (haystack, arr) {\n      return arr.some(function (value) {\n        return haystack.indexOf(value) !== -1;\n      });\n    };\n\n    util.inArray = function (array, value) {\n      return array.indexOf(value) !== -1;\n    };\n\n    util.isArray = function (obj) {\n      return Array.isArray(obj) || obj instanceof NodeList;\n    };\n\n    util.each = function (obj, callback) {\n      if (util.isArray(obj)) {\n        for (var idx = 0; idx < obj.length; idx++) {\n          callback(obj[idx], idx);\n        }\n      } else {\n        for (var key in obj) {\n          callback(obj[key], key);\n        }\n      }\n    };\n\n    util.equals = function (a, b) {\n      if (typeof a === 'object') {\n        if (typeof b === 'object') {\n          return util.json.stringify(a) === util.json.stringify(b);\n        } else {\n          return false;\n        }\n      } else {\n        return a === b;\n      }\n    };\n    /* Convert objects\n    --------------------------------------------------- */\n\n\n    util.objectToArray = function (obj) {\n      var res = [];\n\n      for (var key in obj) {\n        res.push(obj[key]);\n      }\n\n      return res;\n    };\n\n    util.arrayToObject = function (arr) {\n      var res = {};\n\n      for (var n = 0, length = arr.length; n < length; n++) {\n        res[arr[n]] = true;\n      }\n\n      return res;\n    };\n    /* Uploader\n    --------------------------------------------------- */\n\n\n    util.addFileInput = function (data, openAsNew) {\n      root.uploader.addFileInput({\n        target: data,\n        onchange: function (uploader) {\n          uploader.fileInput.value = '';\n          uploader.addMedia({\n            openAsNew: openAsNew,\n            self: root.uploader\n          });\n        }\n      });\n    };\n    /* Format bytes\n    ---------------------------------------------------------- */\n\n\n    util.bytesToSize = function (bytes, precision) {\n      if (bytes) {\n        precision = precision || 1;\n        var names = ['Bytes', 'kb', 'mb', 'gb', 'tb'];\n        var n = Math.floor(Math.log(Math.abs(bytes)) / Math.log(1024));\n        return (bytes / Math.pow(1024, n)).toFixed(precision) + names[n];\n      } else {\n        return '0Bytes';\n      }\n    };\n    /* Format time\n    ---------------------------------------------------------- */\n\n\n    util.getTimeFormat = function (timestamp, toString) {\n      // in milliseconds\n      timestamp /= 1000;\n      var hours = timestamp / 3600 >> 0;\n      var minutes = (timestamp - hours * 3600) / 60 >> 0;\n      var seconds = timestamp - hours * 3600 - minutes * 60 >> 0;\n\n      if (toString) {\n        if (hours < 10) hours = '0' + hours;\n        if (minutes < 10) minutes = '0' + minutes;\n        if (seconds < 10) seconds = '0' + seconds;\n        return hours + ':' + minutes + ':' + seconds;\n      } else {\n        return {\n          hours: hours,\n          minutes: minutes,\n          seconds: seconds\n        };\n      }\n    };\n\n    util.require = function (opts) {\n      if (typeof opts === 'string') opts = {\n        url: opts\n      };\n      var url = opts.url;\n      var type = opts.type || (url.indexOf('.css') !== -1 ? 'css' : 'js');\n      var async = opts.async || false;\n      var onsuccess = opts.onsuccess; ///\n\n      if (type === 'css') {\n        if (async) {\n          setTimeout(addCSS, 0);\n        } else {\n          addCSS();\n        }\n      } else {\n        var script = document.createElement('script');\n        script.src = url;\n        script.async = async; ///\n\n        if (onsuccess) {\n          // influenced by jQuery\n          var loaded = false;\n\n          script.onload = script.onreadystatechange = function () {\n            if (loaded === false) {\n              var readyState = script.readyState;\n\n              if (!readyState || /loaded|complete/.test(readyState)) {\n                loaded = true;\n                onsuccess(); // Handle memory leak in IE\n\n                script.onload = script.onreadystatechange = null;\n              }\n            }\n\n            ;\n          };\n        } ///\n\n\n        document.head.appendChild(script);\n      }\n\n      function addCSS() {\n        var link = document.createElement('link');\n        link.href = url;\n        link.setAttribute('type', 'text/css');\n        link.setAttribute('rel', 'stylesheet');\n        document.head.appendChild(link);\n      }\n\n      ;\n    };\n    /* Detect whether focus element is editable node\n    ---------------------------------------------------------- */\n\n\n    util.isEditingText = function () {\n      // from eventjs\n      var node = document.activeElement;\n      if (!node) return false;\n      var nodeName = node.nodeName;\n\n      if (nodeName === 'INPUT' || nodeName === 'TEXTAREA' || node.contentEditable === 'true') {\n        if (node.classList.contains('sk-canvas-dummy')) return false;\n        return true;\n      } else {\n        return false;\n      }\n    };\n    /* Pending queue\n    ---------------------------------------------------------- */\n\n\n    util.pending = function (length, onsuccess) {\n      var pending = length;\n      return {\n        add: function (amount) {\n          pending += amount || 1;\n        },\n        next: function () {\n          if (! --pending) {\n            onsuccess();\n          }\n        }\n      };\n    };\n  }; /// NodeJS\n\n\n  if (typeof module !== 'undefined' && module.exports) {\n    try {//TODO-PER: to make it compile var Canvas = require('canvas');\n    } catch (e) {} ///\n\n\n    module.exports = root.module.DOMMisc;\n  } else {\n    root.module.DOMMisc(galactic);\n  }\n})(galactic);","map":{"version":3,"sources":["/Users/HTMusic/Desktop/PROJECTS/subdivision-app/subdivision-app_v2/node_modules/midi/inc/dom/util.js"],"names":["galactic","root","module","DOMMisc","util","inherits","child","parent","temp","prototype","constructor","errorHandler","type","console","warn","arguments","requestKioskMode","client","nodewebkit","win","enterKioskMode","diff","_from","_to","_retain","from","to","equal","key","indexOf","undefined","sort","opts","fn","data","param","res","Array","isArray","a","b","Object","keys","forEach","idx","numeric","natural","re","sre","dre","hre","ore","x","toString","replace","y","xN","split","yN","xD","parseInt","match","length","Date","parse","yD","cLoc","numS","Math","max","oFxNcL","parseFloat","oFyNcL","isNaN","getItems","onsuccess","pending","each","getItem","value","log","JSON","err","exists","chrome","storage","local","get","prefix","feature","prefixed","localStorage","setItem","obj","set","Canvas","width","height","document","ctx","canvas","createElement","FlashCanvas","onload","detect","getContext","isFinite","resize","clear","clearRect","Context3d","Context2d","json","pretty","stringify","nodeName","tagName","timestamp","window","performance","now","bind","perf","amount","title","n","start","reset","round","path","base","parts","copy","excludePattern","CanvasPattern","src","nodeType","clone","fvalue","copyInto","dst","tvalue","filter","ftype","referenceNodes","count","whereKey","whereValue","useKey","useValue","isEmpty","isNotEmpty","clamp","min","clampFinite","INFINITY","arrayEmpty","arr","splice","arrayIntersects","haystack","some","inArray","array","NodeList","callback","equals","objectToArray","push","arrayToObject","addFileInput","openAsNew","uploader","target","onchange","fileInput","addMedia","self","bytesToSize","bytes","precision","names","floor","abs","pow","toFixed","getTimeFormat","hours","minutes","seconds","require","url","async","setTimeout","addCSS","script","loaded","onreadystatechange","readyState","test","head","appendChild","link","href","setAttribute","isEditingText","node","activeElement","contentEditable","classList","contains","add","next","exports","e"],"mappings":"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","sourcesContent":["/*\n\t-------------------------------------------------------\n\tutil/DOMMisc : 0.2.1 : 2015-04-27 : https://sketch.io\n\t-------------------------------------------------------\n*/\n\nif (typeof galactic === 'undefined') galactic = {};\n\n(function(root) { 'use strict';\n\nroot.module = root.module || {};\nroot.module.DOMMisc = function(root) {\n\n\tvar util = root.util || (root.util = {});\n\n\t/* Inherits\n\t---------------------------------------------------------- */\n\tutil.inherits = function(child, parent) {\n\t\tfunction temp() {};\n\t\ttemp.prototype = parent.prototype;\n\t\tchild.prototype = new temp();\n\t\tchild.prototype.constructor = child;\n\t};\n\n\n\t/* Error handler\n\t---------------------------------------------------------- */\n\tutil.errorHandler = function(type) {\n\t\treturn function() {\n\t\t\tconsole.warn(type, arguments);\n\t\t};\n\t};\n\n\n\t/* Kiosk\n\t---------------------------------------------------------- */\n\tutil.requestKioskMode = function() {\n\t\tif (root.client.nodewebkit) {\n\t\t\t//TODO-PER: to make it compile\t\t\tvar win = require('nw.gui').Window.get();\n\t\t\twin.enterKioskMode();\n\t\t} else {\n//\t\t\troot.FullScreen.enter();\n\t\t}\n\t};\n\n\n\t/* Diff\n\t---------------------------------------------------------- */\n\tutil.diff = function(_from, _to, _retain) { // see style.js\n\t\tif (_from === _to) return;\n\t\t///\n\t\tvar from = new _from.constructor();\n\t\tvar to = new _to.constructor();\n\t\tvar equal = true;\n\t\tfor (var key in _from) {\n\t\t\tif (_retain && _retain.indexOf(key) !== -1) {\n\t\t\t\tfrom[key] = _from[key];\n\t\t\t\tto[key] = _to[key];\n\t\t\t} else if (!(key in _to)) {\n\t\t\t\tequal = false;\n\t\t\t\tfrom[key] = _from[key];\n\t\t\t\tto[key] = _to[key];\n\t\t\t} else {\n\t\t\t\tif (_from[key] !== _to[key]) {\n\t\t\t\t\tif (typeof _from[key] === 'object' && typeof _to[key] === 'object') {\n\t\t\t\t\t\tvar diff = util.diff(_from[key], _to[key], _retain);\n\t\t\t\t\t\tif (diff !== undefined) {\n\t\t\t\t\t\t\tequal = false;\n\t\t\t\t\t\t\tfrom[key] = diff.from;\n\t\t\t\t\t\t\tto[key] = diff.to;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tequal = false;\n\t\t\t\t\t\tfrom[key] = _from[key];\n\t\t\t\t\t\tto[key] = _to[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (var key in _to) {\n\t\t\tif (!(key in _from)) {\n\t\t\t\tequal = false;\n\t\t\t\tfrom[key] = _from[key];\n\t\t\t\tto[key] = _to[key];\n\t\t\t}\n\t\t}\n\t\tif (!equal) {\n\t\t\treturn {\n\t\t\t\tfrom: from,\n\t\t\t\tto: to\n\t\t\t};\n\t\t}\n\t};\n\n\n\t/* Sort\n\t--------------------------------------------------- \n\t\tutil.sort({\n\t\t\tfn: 'natural', // string | custom function\n\t\t\tdata: {},\n\t\t\tparam: 'columnId'\n\t\t});\n\t*/\n\tutil.sort = function(opts) {\n\t\tvar fn = util.sort[opts.fn] || opts.fn;\n\t\tvar data = opts.data || opts;\n\t\tvar param = opts.param;\n\t\t///\n\t\tvar res;\n\t\tif (Array.isArray(data)) { // sort arrays\n\t\t\tif (param) { // sort array by param\n\t\t\t\tres = data.sort(function(a, b) {\n\t\t\t\t\treturn fn(a[param], b[param]);\n\t\t\t\t});\n\t\t\t} else { // sort array with custom function\n\t\t\t\tres = data.sort(fn);\n\t\t\t}\n\t\t} else { // sort object by key\n\t\t\tres = {};\n\t\t\tObject.keys(data).sort(fn).forEach(function(idx) {\n\t\t\t\tres[idx] = data[idx];\n\t\t\t});\n\t\t}\n\t\treturn res;\n\t};\n\t\n\tutil.sort.numeric = function(a, b) {\n\t\treturn a - b;\n\t};\n\n\t/*\n\t * Natural Sort algorithm for Javascript - Version 0.6 - Released under MIT license\n\t * Author: Jim Palmer (based on chunking idea from Dave Koelle)\n\t * Contributors: Mike Grier (mgrier.com), Clint Priest, Kyle Adams, guillermo\n\t */\n\tutil.sort.natural = function(a, b) { // http://www.overset.com/2008/09/01/javascript-natural-sort-algorithm-with-unicode-support/\n\t\tvar re = /(^-?[0-9]+(\\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi;\n\t\tvar sre = /(^[ ]*|[ ]*$)/g;\n\t\tvar dre = /(^([\\w ]+,?[\\w ]+)?[\\w ]+,?[\\w ]+\\d+:\\d+(:\\d+)?[\\w ]?|^\\d{1,4}[\\/\\-]\\d{1,4}[\\/\\-]\\d{1,4}|^\\w+, \\w+ \\d+, \\d{4})/;\n\t\tvar hre = /^0x[0-9a-f]+$/i;\n\t\tvar ore = /^0/;\n\t\t// convert all to strings and trim()\n\t\tvar x = a.toString().replace(sre, '') || '';\n\t\tvar y = b.toString().replace(sre, '') || '';\n\t\t// chunk/tokenize\n\t\tvar xN = x.replace(re, '\\0$1\\0').replace(/\\0$/, '').replace(/^\\0/, '').split('\\0');\n\t\tvar yN = y.replace(re, '\\0$1\\0').replace(/\\0$/, '').replace(/^\\0/, '').split('\\0');\n\t\t// numeric, hex or date detection\n\t\tvar xD = parseInt(x.match(hre)) || (xN.length != 1 && x.match(dre) && Date.parse(x));\n\t\tvar yD = parseInt(y.match(hre)) || xD && y.match(dre) && Date.parse(y) || null;\n\n\t\t// first try and sort Hex codes or Dates\n\t\tif (yD) {\n\t\t\tif (xD < yD) {\n\t\t\t\treturn -1;\n\t\t\t} else if (xD > yD) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\n\t\t// natural sorting through split numeric strings and default strings\n\t\tfor (var cLoc = 0, numS = Math.max(xN.length, yN.length); cLoc < numS; cLoc++) {\n\t\t\t// find floats not starting with '0', string or 0 if not defined (Clint Priest)\n\t\t\tvar oFxNcL = !(xN[cLoc] || '').match(ore) && parseFloat(xN[cLoc]) || xN[cLoc] || 0;\n\t\t\tvar oFyNcL = !(yN[cLoc] || '').match(ore) && parseFloat(yN[cLoc]) || yN[cLoc] || 0;\n\t\t\t// handle numeric vs string comparison - number < string - (Kyle Adams)\n\t\t\tif (isNaN(oFxNcL) !== isNaN(oFyNcL)) {\n\t\t\t\treturn (isNaN(oFxNcL)) ? 1 : -1;\n\t\t\t} else if (typeof oFxNcL !== typeof oFyNcL) {\n\t\t\t\t// rely on string comparison if different types - i.e. '02' < 2 != '02' < '2'\n\t\t\t\toFxNcL += '';\n\t\t\t\toFyNcL += '';\n\t\t\t}\n\t\t\tif (oFxNcL < oFyNcL) {\n\t\t\t\treturn -1;\n\t\t\t} else if (oFxNcL > oFyNcL) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t};\n\n\n\t/* LocalStorage\n\t--------------------------------------------------- */\n\tutil.getItems = function(keys, onsuccess) {\n\t\tvar pending = keys.length;\n\t\tvar res = {};\n\t\tutil.each(keys, function(key) {\n\t\t\tutil.getItem(key, function(value) {\n\t\t\t\tres[key] = value;\n\t\t\t\t///\n\t\t\t\tif (!--pending) {\n\t\t\t\t\tonsuccess(res);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t};\n\n\tutil.getItem = function(key, onsuccess) {\n\t\tonsuccess = onsuccess || function(value) {\n\t\t    console.log(value);\n\t\t};\n\t\t///\n\t\tvar parse = function(value) {\n\t\t\tif (value) {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse(value);\n\t\t\t\t} catch(err) {}\n\t\t\t}\n\t\t\t///\n\t\t\tonsuccess(value);\n\t\t};\n\t\t///\n\t\tif (util.exists('chrome.storage.local')) { // Chrome Packaged Apps\n\t\t\tchrome.storage.local.get(key, function(data) {\n\t\t\t\tparse(data[key]);\n\t\t\t});\n\t\t} else {\n\t\t\tvar prefix = root.feature && root.feature.prefix || '';\n\t\t\tvar prefixed = prefix + '/' + key;\n\t\t\tvar data = localStorage.getItem(prefixed) || '';\n\t\t\tparse(data);\n\t\t}\n\t};\n\n\tutil.setItem = function(key, value) {\n\t\tif (util.exists('chrome.storage.local')) { // Chrome Packaged Apps\n\t\t\tvar obj = {};\n\t\t\tobj[key] = value;\n\t\t\tchrome.storage.local.set(obj);\n\t\t} else {\n\t\t\tvar prefix = root.feature && root.feature.prefix || '';\n\t\t\tvar prefixed = prefix + '/' + key;\n\t\t\tlocalStorage.setItem(prefixed, value);\n\t\t}\n\t};\n\n\n\t/* Canvas\n\t--------------------------------------------------- */\n\tutil.Canvas = function(width, height, type) {\n\t\tif (typeof document === 'undefined') { // NodeJS\n\t\t\tif (Canvas === undefined) {\n\t\t\t\treturn {ctx: {}};\n\t\t\t} else {\n\t\t\t\tvar canvas = new Canvas;\n\t\t\t}\n\t\t} else { // FlashCanvas | DOM\n\t\t\tvar canvas = document.createElement('canvas');\n\t\t\tif (typeof FlashCanvas === 'function') {\n\t\t\t\tcanvas.onload = root.client.fn.detect;\n\t\t\t}\n\t\t}\n\t\t///\n\t\tcanvas.ctx = canvas.getContext(type || '2d');\n\t\t///\n\t\tif (isFinite(width)) {\n\t\t\tcanvas.width = width || 1;\n\t\t}\n\t\tif (isFinite(height)) {\n\t\t\tcanvas.height = height || 1;\n\t\t}\n\t\treturn canvas;\n\t};\n\n\tutil.Canvas.resize = function(canvas, width, height) { // clear context\n\t\tif (width && height) {\n\t\t\tcanvas.width = width;\n\t\t\tcanvas.height = height;\n\t\t} else {\n\t\t\tcanvas.width = canvas.width;\n\t\t}\n\t};\n\n\tutil.Canvas.clear = function(canvas) { // clear context rectangle\n\t\tcanvas.ctx.clearRect(0, 0, canvas.width, canvas.height);\n\t};\n\n\n\t/* Context\n\t--------------------------------------------------- */\n\tutil.Context3d = function(width, height) {\n\t\treturn util.Canvas(width, height, 'webgl').ctx;\n\t};\n\t\n\tutil.Context2d = function(width, height) {\n\t\treturn util.Canvas(width, height, '2d').ctx;\n\t};\n\t\n\n\t/* JSON\n\t--------------------------------------------------- */\n\tutil.json = {};\n\tutil.json.pretty = function(data) {\n\t\treturn JSON.stringify(data, null, '\\t');\n\t};\n\n\tutil.json.stringify = function(data) {\n\t\treturn JSON.stringify(data, function(key, value) { // filter circular\n\t\t\tif (typeof value === 'object') {\n\t\t\t\tif (value === null) return; // NULL\n\t\t\t\tif (value.nodeName) return; // DOM Node\n\t\t\t\tif (value.tagName) return; // DOM Element\n\t\t\t}\n\t\t\treturn value;\n\t\t});\n\t};\n\n\n\t/* Timestamp\n\t--------------------------------------------------- */\n\tutil.timestamp = (function() {\n\t\tif (typeof window === 'object') {\n\t\t\tvar performance = window.performance;\n\t\t\tif (performance && performance.now) {\n\t\t\t\treturn performance.now.bind(performance);\n\t\t\t}\n\t\t}\n\t\treturn Date.now;\n\t})();\n\n\n\t/* Perf\n\t--------------------------------------------------- */\n\tutil.perf = function(fn, amount, title) {\n\t\tif (amount && fn) {\n\t\t\tvar perf = util.perf();\n\t\t\tfor (var n = 0; n < amount; n ++) fn();\n\t\t\tconsole.log(perf() + 'ms', title || '');\n\t\t} else {\n\t\t\tvar start = util.timestamp();\n\t\t\treturn function(title, reset) {\n\t\t\t\tvar now = util.timestamp();\n\t\t\t\tvar diff = Math.round(now - start);\n\t\t\t\tif (title) {\n\t\t\t\t\tconsole.log(diff + 'ms', title);\n\t\t\t\t}\n\t\t\t\tif (reset) {\n\t\t\t\t\tstart = now;\n\t\t\t\t}\n\t\t\t\treturn diff;\n\t\t\t};\n\t\t}\n\t};\n\n\tutil.exists = function(path, base) { // exists('scene.children', sketch)\n\t\ttry {\n\t\t\tvar parts = path.split('.');\n\t\t\tvar obj = base || window;\n\t\t\tfor (var n = 0, length = parts.length; n < length; n ++) {\n\t\t\t\tvar key = parts[n];\n\t\t\t\tif (obj[key] == null) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\tobj = obj[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t} catch(err) {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\n\t/* Clone objects\n\t--------------------------------------------------- */\n\tutil.copy = (function() {\n\t\tvar excludePattern = typeof CanvasPattern === 'function';\n\t\tvar copy = function(src) {\n\t\t\tif (!src || typeof src !== 'object') {\n\t\t\t\treturn src;\n\t\t\t} else if (src.nodeType) {\n\t\t\t\treturn; // dom element\n\t\t\t} else if (excludePattern && src instanceof CanvasPattern) {\n\t\t\t\treturn;\n\t\t\t} else if (src.clone && typeof src.clone === 'function') {\n\t\t\t\treturn src.clone();\n\t\t\t} else if (src.constructor) {\n\t\t\t\tvar temp = new src.constructor();\n\t\t\t\tfor (var key in src) {\n\t\t\t\t\tvar fvalue = src[key];\n\t\t\t\t\tif (!fvalue || typeof fvalue !== 'object') {\n\t\t\t\t\t\ttemp[key] = fvalue;\n\t\t\t\t\t} else { // clone sub-object\n\t\t\t\t\t\ttemp[key] = copy(fvalue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn temp;\n\t\t\t}\n\t\t};\n\t\treturn copy;\n\t})();\n\n\n\t/* Merge objects\n\t--------------------------------------------------- */\n\tutil.copyInto = (function() {\n\t\tvar copyInto = function(src, dst, opts) {\n\t\t\topts = opts || {};\n\t\t\tif (src && typeof src === 'object') {\n\t\t\t\tfor (var key in src) {\n\t\t\t\t\tvar tvalue = dst[key];\n\t\t\t\t\tvar fvalue = src[key];\n\t\t\t\t\t///\n\t\t\t\t\tvar filter = opts.filter;\n\t\t\t\t\tif (filter && filter(fvalue, tvalue)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t///\n\t\t\t\t\tvar ftype = typeof fvalue;\n\t\t\t\t\tif (fvalue && ftype === 'object') {\n\t\t\t\t\t\tif (fvalue.nodeType) {\n\t\t\t\t\t\t\tif (opts.referenceNodes) {\n\t\t\t\t\t\t\t\tdst[key] = fvalue;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcontinue; // dom element\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (typeof tvalue === ftype) {\n\t\t\t\t\t\t\t\tdst[key] = copyInto(fvalue, tvalue, opts);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdst[key] = copyInto(fvalue, new fvalue.constructor(), opts);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdst[key] = fvalue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dst;\n\t\t};\n\t\treturn copyInto;\n\t})();\n\n\n\t/* Count objects\n\t--------------------------------------------------- */\n\tutil.count = function(obj, whereKey, whereValue) {\n\t\tif (obj) {\n\t\t\tif (isFinite(obj.length)) {\n\t\t\t\treturn obj.length;\n\t\t\t} else if (typeof obj === 'object') {\n\t\t\t\tvar length = 0;\n\t\t\t\tvar useKey = whereKey !== undefined; //- replace with filter()\n\t\t\t\tvar useValue = whereValue !== undefined;\n\t\t\t\tif (useKey && useValue) {\n\t\t\t\t\tfor (var key in obj) {\n\t\t\t\t\t\tif (obj[key] && obj[key][whereKey] === whereValue) {\n\t\t\t\t\t\t\t++ length;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (useKey) {\n\t\t\t\t\tfor (var key in obj) {\n\t\t\t\t\t\tif (obj[key] !== undefined) {\n\t\t\t\t\t\t\t++ length;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (var key in obj) ++ length;\n\t\t\t\t}\n\t\t\t\treturn length;\n\t\t\t}\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t};\n\n\tutil.isEmpty = function(obj) {\n\t\tif (obj == null) { // undefined | null\n\t\t\treturn true;\n\t\t} else if (obj.length >= 0) { // array | string | arguments\n\t\t\treturn !obj.length;\n\t\t} else { // object\n\t\t\tfor (var key in obj) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t};\n\n\tutil.isNotEmpty = function(obj) {\n\t\treturn !util.isEmpty(obj);\n\t};\n\n\tutil.clamp = function(min, max, value) {\n\t\treturn (value < min) ? min : ((value > max) ? max : value);\n\t};\n\n\tutil.clampFinite = function(value) {\n\t\tvar INFINITY = util.INFINITY;\n\t\tif (value > +INFINITY) value = +INFINITY;\n\t\tif (value < -INFINITY) value = -INFINITY;\n\t\treturn value;\n\t};\n\t\n\tutil.arrayEmpty = function(arr) {\n\t\tarr.splice(0, arr.length);\n\t};\n\t\n\tutil.arrayIntersects = function(haystack, arr) {\n\t\treturn arr.some(function(value) {\n\t\t\treturn haystack.indexOf(value) !== -1;\n\t\t});\n\t};\n\n\tutil.inArray = function(array, value) {\n\t\treturn array.indexOf(value) !== -1;\n\t};\n\n\tutil.isArray = function(obj) {\n\t\treturn Array.isArray(obj) || obj instanceof NodeList;\n\t};\n\n\tutil.each = function(obj, callback) {\n\t\tif (util.isArray(obj)) {\n\t\t\tfor (var idx = 0; idx < obj.length; idx ++) {\n\t\t\t\tcallback(obj[idx], idx);\n\t\t\t}\n\t\t} else {\n\t\t\tfor (var key in obj) {\n\t\t\t\tcallback(obj[key], key);\n\t\t\t}\n\t\t}\n\t};\n\n\tutil.equals = function(a, b) {\n\t\tif (typeof a === 'object') {\n\t\t\tif (typeof b === 'object') {\n\t\t\t\treturn util.json.stringify(a) === util.json.stringify(b);\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else {\n\t\t\treturn a === b;\n\t\t}\n\t};\n\n\n\t/* Convert objects\n\t--------------------------------------------------- */\n\tutil.objectToArray = function(obj) {\n\t\tvar res = [];\n\t\tfor (var key in obj) {\n\t\t\tres.push(obj[key]);\n\t\t}\n\t\treturn res;\n\t};\n\n\tutil.arrayToObject = function(arr) {\n\t\tvar res = {};\n\t\tfor (var n = 0, length = arr.length; n < length; n ++) {\n\t\t\tres[arr[n]] = true;\n\t\t}\n\t\treturn res;\n\t};\n\n\n\t/* Uploader\n\t--------------------------------------------------- */\n\tutil.addFileInput = function(data, openAsNew) {\n\t\troot.uploader.addFileInput({\n\t\t\ttarget: data,\n\t\t\tonchange: function(uploader) {\n\t\t\t\tuploader.fileInput.value = '';\n\t\t\t\tuploader.addMedia({\n\t\t\t\t\topenAsNew: openAsNew,\n\t\t\t\t\tself: root.uploader\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n\n\n\t/* Format bytes\n\t---------------------------------------------------------- */\n\tutil.bytesToSize = function(bytes, precision) {\n\t\tif (bytes) {\n\t\t\tprecision = precision || 1;\n\t\t\tvar names = ['Bytes', 'kb', 'mb', 'gb', 'tb'];\n\t\t\tvar n = Math.floor(Math.log(Math.abs(bytes)) / Math.log(1024));\n\t\t\treturn (bytes / Math.pow(1024, n)).toFixed(precision) + names[n];\n\t\t} else {\n\t\t\treturn '0Bytes';\n\t\t}\n\t};\n\n\n\t/* Format time\n\t---------------------------------------------------------- */\n\tutil.getTimeFormat = function(timestamp, toString) { // in milliseconds\n\t\ttimestamp /= 1000;\n\t\tvar hours = (timestamp / 3600) >> 0;\n\t\tvar minutes = ((timestamp - (hours * 3600)) / 60) >> 0;\n\t\tvar seconds = (timestamp - (hours * 3600) - (minutes * 60)) >> 0;\n\t\tif (toString) {\n\t\t\tif (hours < 10) hours = '0' + hours;\n\t\t\tif (minutes < 10) minutes = '0' + minutes;\n\t\t\tif (seconds < 10) seconds = '0' + seconds;\n\t\t\treturn hours + ':' + minutes + ':' + seconds;\n\t\t} else {\n\t\t\treturn {\n\t\t\t\thours: hours,\n\t\t\t\tminutes: minutes,\n\t\t\t\tseconds: seconds\n\t\t\t};\n\t\t}\n\t};\n\n\tutil.require = function(opts) {\n\t\tif (typeof opts === 'string') opts = {url: opts};\n\t\tvar url = opts.url;\n\t\tvar type = opts.type || (url.indexOf('.css') !== -1 ? 'css' : 'js');\n\t\tvar async = opts.async || false;\n\t\tvar onsuccess = opts.onsuccess;\n\t\t///\n\t\tif (type === 'css') {\n\t\t\tif (async) {\n\t\t\t\tsetTimeout(addCSS, 0);\n\t\t\t} else {\n\t\t\t\taddCSS();\n\t\t\t}\n\t\t} else {\n\t\t\tvar script = document.createElement('script');\n\t\t\tscript.src = url;\n\t\t\tscript.async = async;\n\t\t\t///\n\t\t\tif (onsuccess) { // influenced by jQuery\n\t\t\t\tvar loaded = false;\n\t\t\t\tscript.onload = script.onreadystatechange = function() {\n\t\t\t\t\tif (loaded === false) {\n\t\t\t\t\t\tvar readyState = script.readyState;\n\t\t\t\t\t\tif (!readyState || /loaded|complete/.test(readyState)) {\n\t\t\t\t\t\t\tloaded = true;\n\t\t\t\t\t\t\tonsuccess();\n\t\t\t\t\t\t\t// Handle memory leak in IE\n\t\t\t\t\t\t\tscript.onload = script.onreadystatechange = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\t\t\t///\n\t\t\tdocument.head.appendChild(script);\n\t\t}\n\t\t\n\t\tfunction addCSS() {\n\t\t\tvar link = document.createElement('link');\n\t\t\tlink.href = url;\n\t\t\tlink.setAttribute('type', 'text/css');\n\t\t\tlink.setAttribute('rel', 'stylesheet');\n\t\t\tdocument.head.appendChild(link);\n\t\t};\n\t};\n\n\n\t/* Detect whether focus element is editable node\n\t---------------------------------------------------------- */\n\tutil.isEditingText = function() { // from eventjs\n\t\tvar node = document.activeElement;\n\t\tif (!node) return false;\n\t\tvar nodeName = node.nodeName;\n\t\tif (nodeName === 'INPUT' || nodeName === 'TEXTAREA' || node.contentEditable === 'true') {\n\t\t\tif (node.classList.contains('sk-canvas-dummy')) return false;\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\n\t/* Pending queue\n\t---------------------------------------------------------- */\n\tutil.pending = function(length, onsuccess) {\n\t\tvar pending = length;\n\t\treturn {\n\t\t\tadd: function(amount) {\n\t\t\t\tpending += amount || 1;\n\t\t\t},\n\t\t\tnext: function() {\n\t\t\t\tif (!--pending) {\n\t\t\t\t\tonsuccess();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t};\n};\n\n/// NodeJS\nif (typeof module !== 'undefined' && module.exports) {\n\ttry {\n\t\t//TODO-PER: to make it compile var Canvas = require('canvas');\n\t} catch(e) {}\n\t///\n\tmodule.exports = root.module.DOMMisc;\n} else {\n\troot.module.DOMMisc(galactic);\n}\n\n})(galactic);"]},"metadata":{},"sourceType":"script"}