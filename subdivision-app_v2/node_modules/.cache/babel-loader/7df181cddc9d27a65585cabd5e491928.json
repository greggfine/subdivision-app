{"ast":null,"code":"//    abc_voice_element.js: Definition of the VoiceElement class.\n//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen\n//\n//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\n//    documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation\n//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and\n//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n//\n//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n//\n//    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING\n//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n//    NON-INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n/*global module */\nvar svgNS = \"http://www.w3.org/2000/svg\";\n\nfunction Svg(wrapper) {\n  this.svg = createSvg();\n  wrapper.appendChild(this.svg);\n}\n\nSvg.prototype.clear = function () {\n  if (this.svg) {\n    var wrapper = this.svg.parentNode;\n    this.svg = createSvg();\n\n    if (wrapper) {\n      // TODO-PER: If the wrapper is not present, then the underlying div was pulled out from under this instance. It's possible that is still useful (for creating the music off page?)\n      wrapper.innerHTML = \"\";\n      wrapper.appendChild(this.svg);\n    }\n  }\n};\n\nSvg.prototype.setTitle = function (title) {\n  var titleEl = document.createElement(\"title\");\n  var titleNode = document.createTextNode(title);\n  titleEl.appendChild(titleNode);\n  this.svg.insertBefore(titleEl, this.svg.firstChild);\n};\n\nSvg.prototype.setResponsiveWidth = function (w, h) {\n  // this technique is from: http://thenewcode.com/744/Make-SVG-Responsive, thx to https://github.com/iantresman\n  this.svg.setAttribute(\"viewBox\", \"0 0 \" + w + \" \" + h);\n  this.svg.setAttribute(\"preserveAspectRatio\", \"xMinYMin meet\");\n  this.svg.removeAttribute(\"height\");\n  this.svg.removeAttribute(\"width\");\n  this.svg.style['display'] = \"inline-block\";\n  this.svg.style['position'] = \"absolute\";\n  this.svg.style['top'] = \"0\";\n  this.svg.style['left'] = \"0\";\n\n  if (this.svg.parentNode) {\n    var cls = this.svg.parentNode.getAttribute(\"class\");\n    if (!cls) this.svg.parentNode.setAttribute(\"class\", \"abcjs-container\");else if (cls.indexOf(\"abcjs-container\") < 0) this.svg.parentNode.setAttribute(\"class\", cls + \" abcjs-container\");\n    this.svg.parentNode.style['display'] = \"inline-block\";\n    this.svg.parentNode.style['position'] = \"relative\";\n    this.svg.parentNode.style['width'] = \"100%\"; // PER: I changed the padding from 100% to this through trial and error.\n    // The example was using a square image, but this music might be either wider or taller.\n\n    var padding = h / w * 100;\n    this.svg.parentNode.style['padding-bottom'] = padding + \"%\";\n    this.svg.parentNode.style['vertical-align'] = \"middle\";\n    this.svg.parentNode.style['overflow'] = \"hidden\";\n  }\n};\n\nSvg.prototype.setSize = function (w, h) {\n  this.svg.setAttribute('width', w);\n  this.svg.setAttribute('height', h); // TODO-PER: Is this hack still needed?\n  // Correct for IE problem in calculating height\n  // var isIE = /*@cc_on!@*/false;//IE detector\n  // if (isIE) {\n  // \tthis.paper.canvas.parentNode.style.width = w + \"px\";\n  // \tthis.paper.canvas.parentNode.style.height = \"\" + h + \"px\";\n  // } else\n  // \tthis.paper.canvas.parentNode.setAttribute(\"style\", \"width:\" + w + \"px\");\n};\n\nSvg.prototype.setScale = function (scale) {\n  if (scale !== 1) {\n    this.svg.style.transform = \"scale(\" + scale + \",\" + scale + \")\";\n    this.svg.style['-ms-transform'] = \"scale(\" + scale + \",\" + scale + \")\";\n    this.svg.style['-webkit-transform'] = \"scale(\" + scale + \",\" + scale + \")\";\n    this.svg.style['transform-origin'] = \"0 0\";\n    this.svg.style['-ms-transform-origin-x'] = \"0\";\n    this.svg.style['-ms-transform-origin-y'] = \"0\";\n    this.svg.style['-webkit-transform-origin-x'] = \"0\";\n    this.svg.style['-webkit-transform-origin-y'] = \"0\";\n  } else {\n    this.svg.style.transform = \"\";\n    this.svg.style['-ms-transform'] = \"\";\n    this.svg.style['-webkit-transform'] = \"\";\n  }\n};\n\nSvg.prototype.setParentStyles = function (attr) {\n  // This is needed to get the size right when there is scaling involved.\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      if (this.svg.parentNode) this.svg.parentNode.style[key] = attr[key];\n    }\n  }\n};\n\nSvg.prototype.rect = function (attr) {\n  var el = document.createElementNS(svgNS, \"rect\");\n\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      var tmp = \"\" + attr[key];\n      if (tmp.indexOf(\"NaN\") >= 0) debugger;\n      el.setAttributeNS(null, key, attr[key]);\n    }\n  }\n\n  this.append(el);\n  return el;\n};\n\nSvg.prototype.text = function (text, attr) {\n  var el = document.createElementNS(svgNS, 'text');\n\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      el.setAttribute(key, attr[key]);\n    }\n  }\n\n  var lines = (\"\" + text).split(\"\\n\");\n\n  for (var i = 0; i < lines.length; i++) {\n    var line = document.createElementNS(svgNS, 'tspan');\n    line.textContent = lines[i];\n    line.setAttribute(\"x\", attr.x ? attr.x : 0);\n    if (i !== 0) line.setAttribute(\"dy\", \"1.2em\");\n    el.appendChild(line);\n  }\n\n  this.append(el);\n  return el;\n};\n\nSvg.prototype.getTextSize = function (text, attr) {\n  var el = this.text(text, attr);\n  var size = el.getBBox();\n  if (isNaN(size.height)) // This can happen if the element isn't visible.\n    size = {\n      width: 0,\n      height: 0\n    };else size = {\n    width: size.width,\n    height: size.height\n  }; // TODO-PER: can the size be gotten without inserting and deleting the element?\n\n  if (this.currentGroup) this.currentGroup.removeChild(el);else this.svg.removeChild(el);\n  return size;\n};\n\nSvg.prototype.openGroup = function (options) {\n  options = options ? options : {};\n  var el = document.createElementNS(svgNS, \"g\");\n  if (options.prepend) this.svg.insertBefore(el, this.svg.firstChild);else this.svg.appendChild(el);\n  this.currentGroup = el;\n  return el;\n};\n\nSvg.prototype.closeGroup = function () {\n  var g = this.currentGroup;\n  this.currentGroup = null;\n  return g;\n};\n\nSvg.prototype.path = function (attr) {\n  var el = document.createElementNS(svgNS, \"path\");\n\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      if (key === 'path') el.setAttributeNS(null, 'd', attr.path);else el.setAttributeNS(null, key, attr[key]);\n    }\n  }\n\n  this.append(el);\n  return el;\n};\n\nSvg.prototype.pathToBack = function (attr) {\n  var el = document.createElementNS(svgNS, \"path\");\n\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      if (key === 'path') el.setAttributeNS(null, 'd', attr.path);else el.setAttributeNS(null, key, attr[key]);\n    }\n  }\n\n  this.prepend(el);\n  return el;\n};\n\nSvg.prototype.append = function (el) {\n  if (this.currentGroup) this.currentGroup.appendChild(el);else this.svg.appendChild(el);\n};\n\nSvg.prototype.prepend = function (el) {\n  // The entire group is prepended, so don't prepend the individual elements.\n  if (this.currentGroup) this.currentGroup.appendChild(el);else this.svg.insertBefore(el, this.svg.firstChild);\n};\n\nSvg.prototype.setAttributeOnElement = function (el, attr) {\n  for (var key in attr) {\n    if (attr.hasOwnProperty(key)) {\n      el.setAttributeNS(null, key, attr[key]);\n    }\n  }\n};\n\nfunction createSvg() {\n  var svg = document.createElementNS(svgNS, \"svg\");\n  svg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n  svg.setAttribute('role', 'img'); // for accessibility\n\n  return svg;\n}\n\nmodule.exports = Svg;","map":{"version":3,"sources":["/Users/HTMusic/Desktop/PROJECTS/subdivision-app/subdivision-app_v2/node_modules/abcjs/src/write/svg.js"],"names":["svgNS","Svg","wrapper","svg","createSvg","appendChild","prototype","clear","parentNode","innerHTML","setTitle","title","titleEl","document","createElement","titleNode","createTextNode","insertBefore","firstChild","setResponsiveWidth","w","h","setAttribute","removeAttribute","style","cls","getAttribute","indexOf","padding","setSize","setScale","scale","transform","setParentStyles","attr","key","hasOwnProperty","rect","el","createElementNS","tmp","setAttributeNS","append","text","lines","split","i","length","line","textContent","x","getTextSize","size","getBBox","isNaN","height","width","currentGroup","removeChild","openGroup","options","prepend","closeGroup","g","path","pathToBack","setAttributeOnElement","module","exports"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AAEA,IAAIA,KAAK,GAAG,4BAAZ;;AAEA,SAASC,GAAT,CAAaC,OAAb,EAAsB;AACrB,OAAKC,GAAL,GAAWC,SAAS,EAApB;AACAF,EAAAA,OAAO,CAACG,WAAR,CAAoB,KAAKF,GAAzB;AACA;;AAEDF,GAAG,CAACK,SAAJ,CAAcC,KAAd,GAAsB,YAAW;AAChC,MAAI,KAAKJ,GAAT,EAAc;AACb,QAAID,OAAO,GAAG,KAAKC,GAAL,CAASK,UAAvB;AACA,SAAKL,GAAL,GAAWC,SAAS,EAApB;;AACA,QAAIF,OAAJ,EAAa;AACZ;AACAA,MAAAA,OAAO,CAACO,SAAR,GAAoB,EAApB;AACAP,MAAAA,OAAO,CAACG,WAAR,CAAoB,KAAKF,GAAzB;AACA;AACD;AACD,CAVD;;AAYAF,GAAG,CAACK,SAAJ,CAAcI,QAAd,GAAyB,UAASC,KAAT,EAAgB;AACxC,MAAIC,OAAO,GAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAd;AACA,MAAIC,SAAS,GAAGF,QAAQ,CAACG,cAAT,CAAwBL,KAAxB,CAAhB;AACAC,EAAAA,OAAO,CAACP,WAAR,CAAoBU,SAApB;AACA,OAAKZ,GAAL,CAASc,YAAT,CAAsBL,OAAtB,EAA+B,KAAKT,GAAL,CAASe,UAAxC;AACA,CALD;;AAOAjB,GAAG,CAACK,SAAJ,CAAca,kBAAd,GAAmC,UAASC,CAAT,EAAYC,CAAZ,EAAe;AACjD;AACA,OAAKlB,GAAL,CAASmB,YAAT,CAAsB,SAAtB,EAAiC,SAASF,CAAT,GAAa,GAAb,GAAmBC,CAApD;AACA,OAAKlB,GAAL,CAASmB,YAAT,CAAsB,qBAAtB,EAA6C,eAA7C;AACA,OAAKnB,GAAL,CAASoB,eAAT,CAAyB,QAAzB;AACA,OAAKpB,GAAL,CAASoB,eAAT,CAAyB,OAAzB;AACA,OAAKpB,GAAL,CAASqB,KAAT,CAAe,SAAf,IAA4B,cAA5B;AACA,OAAKrB,GAAL,CAASqB,KAAT,CAAe,UAAf,IAA6B,UAA7B;AACA,OAAKrB,GAAL,CAASqB,KAAT,CAAe,KAAf,IAAwB,GAAxB;AACA,OAAKrB,GAAL,CAASqB,KAAT,CAAe,MAAf,IAAyB,GAAzB;;AAEA,MAAI,KAAKrB,GAAL,CAASK,UAAb,EAAyB;AACxB,QAAIiB,GAAG,GAAG,KAAKtB,GAAL,CAASK,UAAT,CAAoBkB,YAApB,CAAiC,OAAjC,CAAV;AACA,QAAI,CAACD,GAAL,EACC,KAAKtB,GAAL,CAASK,UAAT,CAAoBc,YAApB,CAAiC,OAAjC,EAA0C,iBAA1C,EADD,KAEK,IAAIG,GAAG,CAACE,OAAJ,CAAY,iBAAZ,IAAiC,CAArC,EACJ,KAAKxB,GAAL,CAASK,UAAT,CAAoBc,YAApB,CAAiC,OAAjC,EAA0CG,GAAG,GAAG,kBAAhD;AACD,SAAKtB,GAAL,CAASK,UAAT,CAAoBgB,KAApB,CAA0B,SAA1B,IAAuC,cAAvC;AACA,SAAKrB,GAAL,CAASK,UAAT,CAAoBgB,KAApB,CAA0B,UAA1B,IAAwC,UAAxC;AACA,SAAKrB,GAAL,CAASK,UAAT,CAAoBgB,KAApB,CAA0B,OAA1B,IAAqC,MAArC,CARwB,CASxB;AACA;;AACA,QAAII,OAAO,GAAGP,CAAC,GAAGD,CAAJ,GAAQ,GAAtB;AACA,SAAKjB,GAAL,CAASK,UAAT,CAAoBgB,KAApB,CAA0B,gBAA1B,IAA8CI,OAAO,GAAG,GAAxD;AACA,SAAKzB,GAAL,CAASK,UAAT,CAAoBgB,KAApB,CAA0B,gBAA1B,IAA8C,QAA9C;AACA,SAAKrB,GAAL,CAASK,UAAT,CAAoBgB,KAApB,CAA0B,UAA1B,IAAwC,QAAxC;AACA;AACD,CA3BD;;AA6BAvB,GAAG,CAACK,SAAJ,CAAcuB,OAAd,GAAwB,UAAST,CAAT,EAAYC,CAAZ,EAAe;AACtC,OAAKlB,GAAL,CAASmB,YAAT,CAAsB,OAAtB,EAA+BF,CAA/B;AACA,OAAKjB,GAAL,CAASmB,YAAT,CAAsB,QAAtB,EAAgCD,CAAhC,EAFsC,CAGtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAXD;;AAaApB,GAAG,CAACK,SAAJ,CAAcwB,QAAd,GAAyB,UAASC,KAAT,EAAgB;AACxC,MAAIA,KAAK,KAAK,CAAd,EAAiB;AAChB,SAAK5B,GAAL,CAASqB,KAAT,CAAeQ,SAAf,GAA2B,WAASD,KAAT,GAAe,GAAf,GAAmBA,KAAnB,GAAyB,GAApD;AACA,SAAK5B,GAAL,CAASqB,KAAT,CAAe,eAAf,IAAkC,WAASO,KAAT,GAAe,GAAf,GAAmBA,KAAnB,GAAyB,GAA3D;AACA,SAAK5B,GAAL,CAASqB,KAAT,CAAe,mBAAf,IAAsC,WAASO,KAAT,GAAe,GAAf,GAAmBA,KAAnB,GAAyB,GAA/D;AACA,SAAK5B,GAAL,CAASqB,KAAT,CAAe,kBAAf,IAAqC,KAArC;AACA,SAAKrB,GAAL,CAASqB,KAAT,CAAe,wBAAf,IAA2C,GAA3C;AACA,SAAKrB,GAAL,CAASqB,KAAT,CAAe,wBAAf,IAA2C,GAA3C;AACA,SAAKrB,GAAL,CAASqB,KAAT,CAAe,4BAAf,IAA+C,GAA/C;AACA,SAAKrB,GAAL,CAASqB,KAAT,CAAe,4BAAf,IAA+C,GAA/C;AACA,GATD,MASO;AACN,SAAKrB,GAAL,CAASqB,KAAT,CAAeQ,SAAf,GAA2B,EAA3B;AACA,SAAK7B,GAAL,CAASqB,KAAT,CAAe,eAAf,IAAkC,EAAlC;AACA,SAAKrB,GAAL,CAASqB,KAAT,CAAe,mBAAf,IAAsC,EAAtC;AACA;AACD,CAfD;;AAiBAvB,GAAG,CAACK,SAAJ,CAAc2B,eAAd,GAAgC,UAASC,IAAT,EAAe;AAC9C;AACA,OAAK,IAAIC,GAAT,IAAgBD,IAAhB,EAAsB;AACrB,QAAIA,IAAI,CAACE,cAAL,CAAoBD,GAApB,CAAJ,EAA8B;AAC7B,UAAI,KAAKhC,GAAL,CAASK,UAAb,EACC,KAAKL,GAAL,CAASK,UAAT,CAAoBgB,KAApB,CAA0BW,GAA1B,IAAiCD,IAAI,CAACC,GAAD,CAArC;AACD;AACD;AACD,CARD;;AAUAlC,GAAG,CAACK,SAAJ,CAAc+B,IAAd,GAAqB,UAASH,IAAT,EAAe;AACnC,MAAII,EAAE,GAAGzB,QAAQ,CAAC0B,eAAT,CAAyBvC,KAAzB,EAAgC,MAAhC,CAAT;;AACA,OAAK,IAAImC,GAAT,IAAgBD,IAAhB,EAAsB;AACrB,QAAIA,IAAI,CAACE,cAAL,CAAoBD,GAApB,CAAJ,EAA8B;AAC7B,UAAIK,GAAG,GAAG,KAAKN,IAAI,CAACC,GAAD,CAAnB;AACA,UAAIK,GAAG,CAACb,OAAJ,CAAY,KAAZ,KAAsB,CAA1B,EACC;AACDW,MAAAA,EAAE,CAACG,cAAH,CAAkB,IAAlB,EAAwBN,GAAxB,EAA6BD,IAAI,CAACC,GAAD,CAAjC;AACA;AACD;;AACD,OAAKO,MAAL,CAAYJ,EAAZ;AACA,SAAOA,EAAP;AACA,CAZD;;AAcArC,GAAG,CAACK,SAAJ,CAAcqC,IAAd,GAAqB,UAASA,IAAT,EAAeT,IAAf,EAAqB;AACzC,MAAII,EAAE,GAAGzB,QAAQ,CAAC0B,eAAT,CAAyBvC,KAAzB,EAAgC,MAAhC,CAAT;;AACA,OAAK,IAAImC,GAAT,IAAgBD,IAAhB,EAAsB;AACrB,QAAIA,IAAI,CAACE,cAAL,CAAoBD,GAApB,CAAJ,EAA8B;AAC7BG,MAAAA,EAAE,CAAChB,YAAH,CAAgBa,GAAhB,EAAqBD,IAAI,CAACC,GAAD,CAAzB;AACA;AACD;;AACD,MAAIS,KAAK,GAAG,CAAC,KAAGD,IAAJ,EAAUE,KAAV,CAAgB,IAAhB,CAAZ;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,KAAK,CAACG,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACtC,QAAIE,IAAI,GAAGnC,QAAQ,CAAC0B,eAAT,CAAyBvC,KAAzB,EAAgC,OAAhC,CAAX;AACAgD,IAAAA,IAAI,CAACC,WAAL,GAAmBL,KAAK,CAACE,CAAD,CAAxB;AACAE,IAAAA,IAAI,CAAC1B,YAAL,CAAkB,GAAlB,EAAuBY,IAAI,CAACgB,CAAL,GAAShB,IAAI,CAACgB,CAAd,GAAkB,CAAzC;AACA,QAAIJ,CAAC,KAAK,CAAV,EACCE,IAAI,CAAC1B,YAAL,CAAkB,IAAlB,EAAwB,OAAxB;AACDgB,IAAAA,EAAE,CAACjC,WAAH,CAAe2C,IAAf;AACA;;AACD,OAAKN,MAAL,CAAYJ,EAAZ;AACA,SAAOA,EAAP;AACA,CAlBD;;AAoBArC,GAAG,CAACK,SAAJ,CAAc6C,WAAd,GAA4B,UAASR,IAAT,EAAeT,IAAf,EAAqB;AAChD,MAAII,EAAE,GAAG,KAAKK,IAAL,CAAUA,IAAV,EAAgBT,IAAhB,CAAT;AACA,MAAIkB,IAAI,GAAGd,EAAE,CAACe,OAAH,EAAX;AACA,MAAIC,KAAK,CAACF,IAAI,CAACG,MAAN,CAAT,EAAwB;AACvBH,IAAAA,IAAI,GAAG;AAAEI,MAAAA,KAAK,EAAE,CAAT;AAAYD,MAAAA,MAAM,EAAE;AAApB,KAAP,CADD,KAGCH,IAAI,GAAG;AAAEI,IAAAA,KAAK,EAAEJ,IAAI,CAACI,KAAd;AAAqBD,IAAAA,MAAM,EAAEH,IAAI,CAACG;AAAlC,GAAP,CAN+C,CAOhD;;AACA,MAAI,KAAKE,YAAT,EACC,KAAKA,YAAL,CAAkBC,WAAlB,CAA8BpB,EAA9B,EADD,KAGC,KAAKnC,GAAL,CAASuD,WAAT,CAAqBpB,EAArB;AACD,SAAOc,IAAP;AACA,CAbD;;AAeAnD,GAAG,CAACK,SAAJ,CAAcqD,SAAd,GAA0B,UAASC,OAAT,EAAkB;AAC3CA,EAAAA,OAAO,GAAGA,OAAO,GAAGA,OAAH,GAAa,EAA9B;AACA,MAAItB,EAAE,GAAGzB,QAAQ,CAAC0B,eAAT,CAAyBvC,KAAzB,EAAgC,GAAhC,CAAT;AACA,MAAI4D,OAAO,CAACC,OAAZ,EACC,KAAK1D,GAAL,CAASc,YAAT,CAAsBqB,EAAtB,EAA0B,KAAKnC,GAAL,CAASe,UAAnC,EADD,KAGC,KAAKf,GAAL,CAASE,WAAT,CAAqBiC,EAArB;AACD,OAAKmB,YAAL,GAAoBnB,EAApB;AACA,SAAOA,EAAP;AACA,CATD;;AAWArC,GAAG,CAACK,SAAJ,CAAcwD,UAAd,GAA2B,YAAW;AACrC,MAAIC,CAAC,GAAG,KAAKN,YAAb;AACA,OAAKA,YAAL,GAAoB,IAApB;AACA,SAAOM,CAAP;AACA,CAJD;;AAMA9D,GAAG,CAACK,SAAJ,CAAc0D,IAAd,GAAqB,UAAS9B,IAAT,EAAe;AACnC,MAAII,EAAE,GAAGzB,QAAQ,CAAC0B,eAAT,CAAyBvC,KAAzB,EAAgC,MAAhC,CAAT;;AACA,OAAK,IAAImC,GAAT,IAAgBD,IAAhB,EAAsB;AACrB,QAAIA,IAAI,CAACE,cAAL,CAAoBD,GAApB,CAAJ,EAA8B;AAC7B,UAAIA,GAAG,KAAK,MAAZ,EACCG,EAAE,CAACG,cAAH,CAAkB,IAAlB,EAAwB,GAAxB,EAA6BP,IAAI,CAAC8B,IAAlC,EADD,KAGC1B,EAAE,CAACG,cAAH,CAAkB,IAAlB,EAAwBN,GAAxB,EAA6BD,IAAI,CAACC,GAAD,CAAjC;AACD;AACD;;AACD,OAAKO,MAAL,CAAYJ,EAAZ;AACA,SAAOA,EAAP;AACA,CAZD;;AAcArC,GAAG,CAACK,SAAJ,CAAc2D,UAAd,GAA2B,UAAS/B,IAAT,EAAe;AACzC,MAAII,EAAE,GAAGzB,QAAQ,CAAC0B,eAAT,CAAyBvC,KAAzB,EAAgC,MAAhC,CAAT;;AACA,OAAK,IAAImC,GAAT,IAAgBD,IAAhB,EAAsB;AACrB,QAAIA,IAAI,CAACE,cAAL,CAAoBD,GAApB,CAAJ,EAA8B;AAC7B,UAAIA,GAAG,KAAK,MAAZ,EACCG,EAAE,CAACG,cAAH,CAAkB,IAAlB,EAAwB,GAAxB,EAA6BP,IAAI,CAAC8B,IAAlC,EADD,KAGC1B,EAAE,CAACG,cAAH,CAAkB,IAAlB,EAAwBN,GAAxB,EAA6BD,IAAI,CAACC,GAAD,CAAjC;AACD;AACD;;AACD,OAAK0B,OAAL,CAAavB,EAAb;AACA,SAAOA,EAAP;AACA,CAZD;;AAcArC,GAAG,CAACK,SAAJ,CAAcoC,MAAd,GAAuB,UAASJ,EAAT,EAAa;AACnC,MAAI,KAAKmB,YAAT,EACC,KAAKA,YAAL,CAAkBpD,WAAlB,CAA8BiC,EAA9B,EADD,KAGC,KAAKnC,GAAL,CAASE,WAAT,CAAqBiC,EAArB;AACD,CALD;;AAOArC,GAAG,CAACK,SAAJ,CAAcuD,OAAd,GAAwB,UAASvB,EAAT,EAAa;AACpC;AACA,MAAI,KAAKmB,YAAT,EACC,KAAKA,YAAL,CAAkBpD,WAAlB,CAA8BiC,EAA9B,EADD,KAGC,KAAKnC,GAAL,CAASc,YAAT,CAAsBqB,EAAtB,EAA0B,KAAKnC,GAAL,CAASe,UAAnC;AACD,CAND;;AAQAjB,GAAG,CAACK,SAAJ,CAAc4D,qBAAd,GAAsC,UAAS5B,EAAT,EAAaJ,IAAb,EAAmB;AACxD,OAAK,IAAIC,GAAT,IAAgBD,IAAhB,EAAsB;AACrB,QAAIA,IAAI,CAACE,cAAL,CAAoBD,GAApB,CAAJ,EAA8B;AAC7BG,MAAAA,EAAE,CAACG,cAAH,CAAkB,IAAlB,EAAwBN,GAAxB,EAA6BD,IAAI,CAACC,GAAD,CAAjC;AACA;AACD;AACD,CAND;;AAQA,SAAS/B,SAAT,GAAqB;AACpB,MAAID,GAAG,GAAGU,QAAQ,CAAC0B,eAAT,CAAyBvC,KAAzB,EAAgC,KAAhC,CAAV;AACAG,EAAAA,GAAG,CAACsC,cAAJ,CAAmB,+BAAnB,EAAoD,aAApD,EAAmE,8BAAnE;AACAtC,EAAAA,GAAG,CAACmB,YAAJ,CAAiB,MAAjB,EAAyB,KAAzB,EAHoB,CAGgB;;AACpC,SAAOnB,GAAP;AACA;;AAGDgE,MAAM,CAACC,OAAP,GAAiBnE,GAAjB","sourcesContent":["//    abc_voice_element.js: Definition of the VoiceElement class.\n//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen\n//\n//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\n//    documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation\n//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and\n//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n//\n//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n//\n//    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING\n//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n//    NON-INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n/*global module */\n\nvar svgNS = \"http://www.w3.org/2000/svg\";\n\nfunction Svg(wrapper) {\n\tthis.svg = createSvg();\n\twrapper.appendChild(this.svg);\n}\n\nSvg.prototype.clear = function() {\n\tif (this.svg) {\n\t\tvar wrapper = this.svg.parentNode;\n\t\tthis.svg = createSvg();\n\t\tif (wrapper) {\n\t\t\t// TODO-PER: If the wrapper is not present, then the underlying div was pulled out from under this instance. It's possible that is still useful (for creating the music off page?)\n\t\t\twrapper.innerHTML = \"\";\n\t\t\twrapper.appendChild(this.svg);\n\t\t}\n\t}\n};\n\nSvg.prototype.setTitle = function(title) {\n\tvar titleEl = document.createElement(\"title\");\n\tvar titleNode = document.createTextNode(title);\n\ttitleEl.appendChild(titleNode);\n\tthis.svg.insertBefore(titleEl, this.svg.firstChild);\n};\n\nSvg.prototype.setResponsiveWidth = function(w, h) {\n\t// this technique is from: http://thenewcode.com/744/Make-SVG-Responsive, thx to https://github.com/iantresman\n\tthis.svg.setAttribute(\"viewBox\", \"0 0 \" + w + \" \" + h);\n\tthis.svg.setAttribute(\"preserveAspectRatio\", \"xMinYMin meet\");\n\tthis.svg.removeAttribute(\"height\");\n\tthis.svg.removeAttribute(\"width\");\n\tthis.svg.style['display'] = \"inline-block\";\n\tthis.svg.style['position'] = \"absolute\";\n\tthis.svg.style['top'] = \"0\";\n\tthis.svg.style['left'] = \"0\";\n\n\tif (this.svg.parentNode) {\n\t\tvar cls = this.svg.parentNode.getAttribute(\"class\");\n\t\tif (!cls)\n\t\t\tthis.svg.parentNode.setAttribute(\"class\", \"abcjs-container\");\n\t\telse if (cls.indexOf(\"abcjs-container\") < 0)\n\t\t\tthis.svg.parentNode.setAttribute(\"class\", cls + \" abcjs-container\");\n\t\tthis.svg.parentNode.style['display'] = \"inline-block\";\n\t\tthis.svg.parentNode.style['position'] = \"relative\";\n\t\tthis.svg.parentNode.style['width'] = \"100%\";\n\t\t// PER: I changed the padding from 100% to this through trial and error.\n\t\t// The example was using a square image, but this music might be either wider or taller.\n\t\tvar padding = h / w * 100;\n\t\tthis.svg.parentNode.style['padding-bottom'] = padding + \"%\";\n\t\tthis.svg.parentNode.style['vertical-align'] = \"middle\";\n\t\tthis.svg.parentNode.style['overflow'] = \"hidden\";\n\t}\n};\n\nSvg.prototype.setSize = function(w, h) {\n\tthis.svg.setAttribute('width', w);\n\tthis.svg.setAttribute('height', h);\n\t// TODO-PER: Is this hack still needed?\n\t// Correct for IE problem in calculating height\n\t// var isIE = /*@cc_on!@*/false;//IE detector\n\t// if (isIE) {\n\t// \tthis.paper.canvas.parentNode.style.width = w + \"px\";\n\t// \tthis.paper.canvas.parentNode.style.height = \"\" + h + \"px\";\n\t// } else\n\t// \tthis.paper.canvas.parentNode.setAttribute(\"style\", \"width:\" + w + \"px\");\n};\n\nSvg.prototype.setScale = function(scale) {\n\tif (scale !== 1) {\n\t\tthis.svg.style.transform = \"scale(\"+scale+\",\"+scale+\")\";\n\t\tthis.svg.style['-ms-transform'] = \"scale(\"+scale+\",\"+scale+\")\";\n\t\tthis.svg.style['-webkit-transform'] = \"scale(\"+scale+\",\"+scale+\")\";\n\t\tthis.svg.style['transform-origin'] = \"0 0\";\n\t\tthis.svg.style['-ms-transform-origin-x'] = \"0\";\n\t\tthis.svg.style['-ms-transform-origin-y'] = \"0\";\n\t\tthis.svg.style['-webkit-transform-origin-x'] = \"0\";\n\t\tthis.svg.style['-webkit-transform-origin-y'] = \"0\";\n\t} else {\n\t\tthis.svg.style.transform = \"\";\n\t\tthis.svg.style['-ms-transform'] = \"\";\n\t\tthis.svg.style['-webkit-transform'] = \"\";\n\t}\n};\n\nSvg.prototype.setParentStyles = function(attr) {\n\t// This is needed to get the size right when there is scaling involved.\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tif (this.svg.parentNode)\n\t\t\t\tthis.svg.parentNode.style[key] = attr[key];\n\t\t}\n\t}\n};\n\nSvg.prototype.rect = function(attr) {\n\tvar el = document.createElementNS(svgNS, \"rect\");\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tvar tmp = \"\" + attr[key];\n\t\t\tif (tmp.indexOf(\"NaN\") >= 0)\n\t\t\t\tdebugger;\n\t\t\tel.setAttributeNS(null, key, attr[key]);\n\t\t}\n\t}\n\tthis.append(el);\n\treturn el;\n};\n\nSvg.prototype.text = function(text, attr) {\n\tvar el = document.createElementNS(svgNS, 'text');\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tel.setAttribute(key, attr[key]);\n\t\t}\n\t}\n\tvar lines = (\"\"+text).split(\"\\n\");\n\tfor (var i = 0; i < lines.length; i++) {\n\t\tvar line = document.createElementNS(svgNS, 'tspan');\n\t\tline.textContent = lines[i];\n\t\tline.setAttribute(\"x\", attr.x ? attr.x : 0);\n\t\tif (i !== 0)\n\t\t\tline.setAttribute(\"dy\", \"1.2em\");\n\t\tel.appendChild(line);\n\t}\n\tthis.append(el);\n\treturn el;\n};\n\nSvg.prototype.getTextSize = function(text, attr) {\n\tvar el = this.text(text, attr);\n\tvar size = el.getBBox();\n\tif (isNaN(size.height)) // This can happen if the element isn't visible.\n\t\tsize = { width: 0, height: 0};\n\telse\n\t\tsize = { width: size.width, height: size.height };\n\t// TODO-PER: can the size be gotten without inserting and deleting the element?\n\tif (this.currentGroup)\n\t\tthis.currentGroup.removeChild(el);\n\telse\n\t\tthis.svg.removeChild(el);\n\treturn size;\n};\n\nSvg.prototype.openGroup = function(options) {\n\toptions = options ? options : {};\n\tvar el = document.createElementNS(svgNS, \"g\");\n\tif (options.prepend)\n\t\tthis.svg.insertBefore(el, this.svg.firstChild);\n\telse\n\t\tthis.svg.appendChild(el);\n\tthis.currentGroup = el;\n\treturn el;\n};\n\nSvg.prototype.closeGroup = function() {\n\tvar g = this.currentGroup;\n\tthis.currentGroup = null;\n\treturn g;\n};\n\nSvg.prototype.path = function(attr) {\n\tvar el = document.createElementNS(svgNS, \"path\");\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tif (key === 'path')\n\t\t\t\tel.setAttributeNS(null, 'd', attr.path);\n\t\t\telse\n\t\t\t\tel.setAttributeNS(null, key, attr[key]);\n\t\t}\n\t}\n\tthis.append(el);\n\treturn el;\n};\n\nSvg.prototype.pathToBack = function(attr) {\n\tvar el = document.createElementNS(svgNS, \"path\");\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tif (key === 'path')\n\t\t\t\tel.setAttributeNS(null, 'd', attr.path);\n\t\t\telse\n\t\t\t\tel.setAttributeNS(null, key, attr[key]);\n\t\t}\n\t}\n\tthis.prepend(el);\n\treturn el;\n};\n\nSvg.prototype.append = function(el) {\n\tif (this.currentGroup)\n\t\tthis.currentGroup.appendChild(el);\n\telse\n\t\tthis.svg.appendChild(el);\n};\n\nSvg.prototype.prepend = function(el) {\n\t// The entire group is prepended, so don't prepend the individual elements.\n\tif (this.currentGroup)\n\t\tthis.currentGroup.appendChild(el);\n\telse\n\t\tthis.svg.insertBefore(el, this.svg.firstChild);\n};\n\nSvg.prototype.setAttributeOnElement = function(el, attr) {\n\tfor (var key in attr) {\n\t\tif (attr.hasOwnProperty(key)) {\n\t\t\tel.setAttributeNS(null, key, attr[key]);\n\t\t}\n\t}\n};\n\nfunction createSvg() {\n\tvar svg = document.createElementNS(svgNS, \"svg\");\n\tsvg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n\tsvg.setAttribute('role', 'img');    // for accessibility\n\treturn svg;\n}\n\n\nmodule.exports = Svg;\n"]},"metadata":{},"sourceType":"script"}